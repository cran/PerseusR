<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="PerseusR Team" />

<meta name="date" content="2018-10-24" />

<title>Using Perseus data in R</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using Perseus data in R</h1>
<h4 class="author"><em>PerseusR Team</em></h4>
<h4 class="date"><em>2018-10-24</em></h4>



<p>PerseusR provides an interface to use perseus data in R and vice versa</p>
<div id="reading-perseus-data-in-r" class="section level1">
<h1>Reading Perseus data in R</h1>
<div id="as-a-list" class="section level2">
<h2>As a list</h2>
<p>The most basic way to import data from perseus into r is as a list whose elements can then be used in any sort of workflow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(PerseusR)

dataFolder &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="dt">package =</span> <span class="st">'PerseusR'</span>)
dataFiles &lt;-<span class="st"> </span><span class="kw">list.files</span>(dataFolder, 
                        <span class="dt">pattern =</span> <span class="st">&quot;matrix[[:digit:]]*.txt&quot;</span>,
                        <span class="dt">full.names=</span><span class="ot">TRUE</span>)
dataFile &lt;-<span class="st"> </span>dataFiles[[<span class="dv">1</span>]]

default_output &lt;-<span class="st"> </span><span class="kw">read.perseus.default</span>(dataFile)
<span class="kw">class</span>(default_output)
<span class="co">#&gt; [1] &quot;list&quot;</span>
<span class="kw">print</span>(default_output)
<span class="co">#&gt; $main</span>
<span class="co">#&gt;         Column_1   Column_2   Column_3</span>
<span class="co">#&gt; Row.1 -1.8605740 -0.3910594  0.2870352</span>
<span class="co">#&gt; Row.2 -1.0443650  1.4728070 -0.5056471</span>
<span class="co">#&gt; Row.3        NaN -0.4742951  0.8499980</span>
<span class="co">#&gt; Row.4  0.4721563  0.6996973 -0.6752246</span>
<span class="co">#&gt; Row.5  0.7463229 -0.1144230  2.2125310</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $annotCols</span>
<span class="co">#&gt;       GO_Process  Name</span>
<span class="co">#&gt; Row.1            Row 1</span>
<span class="co">#&gt; Row.2            Row 2</span>
<span class="co">#&gt; Row.3            Row 3</span>
<span class="co">#&gt; Row.4            Row 4</span>
<span class="co">#&gt; Row.5            Row 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $annotRows</span>
<span class="co">#&gt;          Grouping</span>
<span class="co">#&gt; Column_1   Group1</span>
<span class="co">#&gt; Column_2   Group2</span>
<span class="co">#&gt; Column_3   Group3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $description</span>
<span class="co">#&gt; [1] &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;Name&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $imputeData</span>
<span class="co">#&gt;   Column_1 Column_2 Column_3</span>
<span class="co">#&gt; 1    False    False    False</span>
<span class="co">#&gt; 2    False    False    False</span>
<span class="co">#&gt; 3    False    False    False</span>
<span class="co">#&gt; 4    False    False    False</span>
<span class="co">#&gt; 5    False    False    False</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $qualityData</span>
<span class="co">#&gt;   Column_1 Column_2 Column_3</span>
<span class="co">#&gt; 1        0        0        0</span>
<span class="co">#&gt; 2        0        0        0</span>
<span class="co">#&gt; 3        0        0        0</span>
<span class="co">#&gt; 4        0        0        0</span>
<span class="co">#&gt; 5        0        0        0</span></code></pre></div>
</div>
<div id="as-a-matrixdata-object" class="section level2">
<h2>As a MatrixData object</h2>
<p>The custom <code>MatrixData</code> object is the most faithfull representation of a perseus matrix in R and is an internal class used by this package to validate whether the fields will be compatible with perseus in additional workflows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dm_out &lt;-<span class="st"> </span><span class="kw">read.perseus.as.matrixData</span>(dataFile)
<span class="kw">class</span>(dm_out)
<span class="co">#&gt; [1] &quot;matrixData&quot;</span>
<span class="co">#&gt; attr(,&quot;package&quot;)</span>
<span class="co">#&gt; [1] &quot;PerseusR&quot;</span>
<span class="kw">print</span>(dm_out)
<span class="co">#&gt; An object of class &quot;matrixData&quot;</span>
<span class="co">#&gt; Slot &quot;main&quot;:</span>
<span class="co">#&gt;         Column_1   Column_2   Column_3</span>
<span class="co">#&gt; Row.1 -1.8605740 -0.3910594  0.2870352</span>
<span class="co">#&gt; Row.2 -1.0443650  1.4728070 -0.5056471</span>
<span class="co">#&gt; Row.3        NaN -0.4742951  0.8499980</span>
<span class="co">#&gt; Row.4  0.4721563  0.6996973 -0.6752246</span>
<span class="co">#&gt; Row.5  0.7463229 -0.1144230  2.2125310</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;annotCols&quot;:</span>
<span class="co">#&gt;       GO_Process  Name</span>
<span class="co">#&gt; Row.1            Row 1</span>
<span class="co">#&gt; Row.2            Row 2</span>
<span class="co">#&gt; Row.3            Row 3</span>
<span class="co">#&gt; Row.4            Row 4</span>
<span class="co">#&gt; Row.5            Row 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;annotRows&quot;:</span>
<span class="co">#&gt;          Grouping</span>
<span class="co">#&gt; Column_1   Group1</span>
<span class="co">#&gt; Column_2   Group2</span>
<span class="co">#&gt; Column_3   Group3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;description&quot;:</span>
<span class="co">#&gt; [1] &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;Name&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;imputeData&quot;:</span>
<span class="co">#&gt;   Column_1 Column_2 Column_3</span>
<span class="co">#&gt; 1    False    False    False</span>
<span class="co">#&gt; 2    False    False    False</span>
<span class="co">#&gt; 3    False    False    False</span>
<span class="co">#&gt; 4    False    False    False</span>
<span class="co">#&gt; 5    False    False    False</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;qualityData&quot;:</span>
<span class="co">#&gt;   Column_1 Column_2 Column_3</span>
<span class="co">#&gt; 1        0        0        0</span>
<span class="co">#&gt; 2        0        0        0</span>
<span class="co">#&gt; 3        0        0        0</span>
<span class="co">#&gt; 4        0        0        0</span>
<span class="co">#&gt; 5        0        0        0</span></code></pre></div>
<p>The data matrix object contains the slots that are supported by perseus and can be accessed by the methods of the object (not all of them must be present)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">main</span>(dm_out)
<span class="co">#&gt;         Column_1   Column_2   Column_3</span>
<span class="co">#&gt; Row.1 -1.8605740 -0.3910594  0.2870352</span>
<span class="co">#&gt; Row.2 -1.0443650  1.4728070 -0.5056471</span>
<span class="co">#&gt; Row.3        NaN -0.4742951  0.8499980</span>
<span class="co">#&gt; Row.4  0.4721563  0.6996973 -0.6752246</span>
<span class="co">#&gt; Row.5  0.7463229 -0.1144230  2.2125310</span>
<span class="kw">annotRows</span>(dm_out)
<span class="co">#&gt;          Grouping</span>
<span class="co">#&gt; Column_1   Group1</span>
<span class="co">#&gt; Column_2   Group2</span>
<span class="co">#&gt; Column_3   Group3</span>
<span class="kw">annotCols</span>(dm_out)
<span class="co">#&gt;       GO_Process  Name</span>
<span class="co">#&gt; Row.1            Row 1</span>
<span class="co">#&gt; Row.2            Row 2</span>
<span class="co">#&gt; Row.3            Row 3</span>
<span class="co">#&gt; Row.4            Row 4</span>
<span class="co">#&gt; Row.5            Row 5</span>
PerseusR<span class="op">::</span><span class="kw">description</span>(dm_out) <span class="co"># Biobase has a descr function as well...</span>
<span class="co">#&gt; [1] &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;Name&quot;</span></code></pre></div>
</div>
<div id="as-an-expressionset-object-for-bioconductor-usage" class="section level2">
<h2>As an expressionSet object (for bioconductor usage)</h2>
<p>If you feel more confortable with the bioconductor expression set class, you can also import the data as such.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(Biobase)
<span class="co">#&gt; Loading required package: Biobase</span>
<span class="co">#&gt; Loading required package: BiocGenerics</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'BiocGenerics'</span>
<span class="co">#&gt; The following objects are masked from 'package:parallel':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
<span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
<span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     IQR, mad, sd, var, xtabs</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Filter, Find, Map, Position, Reduce, anyDuplicated, append,</span>
<span class="co">#&gt;     as.data.frame, basename, cbind, colMeans, colSums, colnames,</span>
<span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, get, grep, grepl,</span>
<span class="co">#&gt;     intersect, is.unsorted, lapply, lengths, mapply, match, mget,</span>
<span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, rank, rbind,</span>
<span class="co">#&gt;     rowMeans, rowSums, rownames, sapply, setdiff, sort, table,</span>
<span class="co">#&gt;     tapply, union, unique, unsplit, which, which.max, which.min</span>
<span class="co">#&gt; Welcome to Bioconductor</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Vignettes contain introductory material; view with</span>
<span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span>
<span class="co">#&gt;     'citation(&quot;Biobase&quot;)', and for packages 'citation(&quot;pkgname&quot;)'.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'Biobase'</span>
<span class="co">#&gt; The following objects are masked from 'package:PerseusR':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     description, description&lt;-</span>
eSet_out &lt;-<span class="st"> </span><span class="kw">read.perseus.as.ExpressionSet</span>(dataFile)
<span class="kw">class</span>(eSet_out)
<span class="co">#&gt; [1] &quot;ExpressionSet&quot;</span>
<span class="co">#&gt; attr(,&quot;package&quot;)</span>
<span class="co">#&gt; [1] &quot;Biobase&quot;</span>
<span class="kw">print</span>(eSet_out)
<span class="co">#&gt; ExpressionSet (storageMode: lockedEnvironment)</span>
<span class="co">#&gt; assayData: 5 features, 3 samples </span>
<span class="co">#&gt;   element names: exprs </span>
<span class="co">#&gt; protocolData: none</span>
<span class="co">#&gt; phenoData</span>
<span class="co">#&gt;   sampleNames: Column_1 Column_2 Column_3</span>
<span class="co">#&gt;   varLabels: Grouping</span>
<span class="co">#&gt;   varMetadata: labelDescription</span>
<span class="co">#&gt; featureData</span>
<span class="co">#&gt;   featureNames: Row.1 Row.2 ... Row.5 (5 total)</span>
<span class="co">#&gt;   fvarLabels: GO_Process Name</span>
<span class="co">#&gt;   fvarMetadata: labelDescription</span>
<span class="co">#&gt; experimentData: use 'experimentData(object)'</span>
<span class="co">#&gt; Annotation:     Name</span>

eSet_out<span class="op">@</span>annotation
<span class="co">#&gt; [1] &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;&quot;     &quot;Name&quot;</span></code></pre></div>
<p>and the equivalentes with the perseus functions would go like this:</p>
<ol style="list-style-type: decimal">
<li>The <code>exprs</code> slot in the expressionSet objects would be equivalent to the <code>main</code> data frame in perseus.</li>
<li>The <code>featureData</code> would be equivalent to the <code>annotationCols</code>.</li>
<li>The <code>phenoData</code> would be aquivalent to the <code>annotationRows</code>.</li>
<li>The <code>Annotation</code> would be equivalent to the <code>descr</code>.</li>
</ol>
</div>
</div>
<div id="checking-data-compatibility-in-r" class="section level1">
<h1>Checking Data compatibility in R</h1>
<p>There are a series of functions that check the compatibility R objects with perseus.</p>
<div id="matrixdata" class="section level2">
<h2>MatrixData</h2>
<p>This function would not provide much insight on this kind of object because it is run when constructing it; Therefore if the data is not compatible it would return an error when trying to create it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df &lt;-<span class="st"> </span><span class="kw">matrixData</span>(
    <span class="dt">main =</span> <span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>),
    <span class="dt">annotCols =</span> <span class="kw">data.frame</span>(<span class="dt">c =</span> <span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)),
    <span class="dt">annotRows =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">'1'</span>,<span class="st">'1'</span>))))

<span class="kw">MatrixDataCheck</span>(df)
<span class="co">#&gt; [1] TRUE</span>

my_error &lt;-<span class="st"> </span><span class="kw">try</span>({
  <span class="kw">matrixData</span>(
    <span class="dt">main =</span> <span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">c =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
    <span class="dt">annotCols =</span> <span class="kw">data.frame</span>(<span class="dt">c =</span> <span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)),
    <span class="dt">annotRows =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">'1'</span>,<span class="st">'1'</span>))))
})

<span class="kw">print</span>(my_error)
<span class="co">#&gt; [1] &quot;Error in MatrixDataCheck.default(main = mainDF, annotationRows = annotationRows,  : \n  Size of annotation rows not matching: 3 main columns, but 2 annotations\n&quot;</span>
<span class="co">#&gt; attr(,&quot;class&quot;)</span>
<span class="co">#&gt; [1] &quot;try-error&quot;</span>
<span class="co">#&gt; attr(,&quot;condition&quot;)</span>
<span class="co">#&gt; &lt;simpleError in MatrixDataCheck.default(main = mainDF, annotationRows = annotationRows,     annotationCols = annotationCols, descriptions = descriptions,     imputeData = imputeData, qualityData = qualityData, all_colnames = all_colnames): Size of annotation rows not matching: 3 main columns, but 2 annotations&gt;</span></code></pre></div>
</div>
<div id="lists" class="section level2">
<h2>lists</h2>
<p>In this case this functions would be usefull, since the object is not inherently compatible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">main =</span> <span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>),
    <span class="dt">annotCols =</span> <span class="kw">data.frame</span>(<span class="dt">c =</span> <span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)),
    <span class="dt">annotRows =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">'1'</span>,<span class="st">'1'</span>))))

<span class="kw">MatrixDataCheck</span>(my_list)
<span class="co">#&gt; [1] TRUE</span>

my_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">main =</span> <span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">c =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
    <span class="dt">annotCols =</span> <span class="kw">data.frame</span>(<span class="dt">c =</span> <span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)),
    <span class="dt">annotRows =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">'1'</span>,<span class="st">'1'</span>))))

my_error &lt;-<span class="st"> </span><span class="kw">try</span>({
  <span class="kw">MatrixDataCheck</span>(my_list)
})
<span class="kw">print</span>(my_error)
<span class="co">#&gt; [1] &quot;Error in MatrixDataCheck.default(main = object$main, annotationRows = object$annotRows,  : \n  Size of annotation rows not matching: 3 main columns, but 2 annotations\n&quot;</span>
<span class="co">#&gt; attr(,&quot;class&quot;)</span>
<span class="co">#&gt; [1] &quot;try-error&quot;</span>
<span class="co">#&gt; attr(,&quot;condition&quot;)</span>
<span class="co">#&gt; &lt;simpleError in MatrixDataCheck.default(main = object$main, annotationRows = object$annotRows,     annotationCols = object$annotCols, descriptions = object$descriptions,     imputeData = object$imputeData, qualityData = object$qualityData,     all_colnames = all_colnames): Size of annotation rows not matching: 3 main columns, but 2 annotations&gt;</span></code></pre></div>
</div>
<div id="expressionset-objects" class="section level2">
<h2>expressionSet objects</h2>
<p>Single matrix Expression Sets will usually be compatible, since most of the restriction in matrix data objects also apply to expression set objects (regarding the dimensions and classes of the objects in each of the slots)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eSet &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw">ExpressionSet</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">2</span>))

<span class="kw">MatrixDataCheck</span>(eSet)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
</div>
<div id="writting-data-into-perseus-compatible-text-representations" class="section level1">
<h1>Writting Data into Perseus-compatible text representations</h1>
<p>This is the way in which perseus will read the data again so here are a couple of examples.</p>
<div id="matrixdata-1" class="section level2">
<h2>MatrixData</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here you can use any tipe of conection, similar to th base write... functions</span>
<span class="co"># The usage should be fairly similar to the write.table function</span>

tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(dm_out, tmp.file)
<span class="co">#&gt; NULL</span>

<span class="co"># which would output somethint like this</span>

<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; Column_1 Column_2    Column_3    GO_Process  Name</span>
<span class="co">#&gt; #!{Description}              Name</span>
<span class="co">#&gt; #!{Type}E    E   E   C   T</span>
<span class="co">#&gt; #!{C:Grouping}Group1 Group2  Group3      </span>
<span class="co">#&gt; -1.860574    -0.3910594  0.2870352       Row 1</span>
<span class="co">#&gt; -1.044365    1.472807    -0.5056471      Row 2</span>
<span class="co">#&gt; NaN  -0.4742951  0.849998        Row 3</span>
<span class="co">#&gt; 0.4721563    0.6996973   -0.6752246      Row 4</span>
<span class="co">#&gt; 0.7463229    -0.114423   2.212531        Row 5</span></code></pre></div>
</div>
<div id="data.frame" class="section level2">
<h2>data.frame</h2>
<p>Data frames are converted in such manner that numeric columns are transfered as the main DF and non numerics as the annotation cols of the perseus DF</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
my_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Con1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">Con2 =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">An1 =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])

tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(my_df, <span class="dt">con =</span> tmp.file)
<span class="co">#&gt; NULL</span>

<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; Con1 Con2    An1</span>
<span class="co">#&gt; #!{Type}E    E   C</span>
<span class="co">#&gt; 1    4   a</span>
<span class="co">#&gt; 2    5   b</span>
<span class="co">#&gt; 3    6   c</span></code></pre></div>
</div>
<div id="matrix" class="section level2">
<h2>matrix</h2>
<p>Numeric matrices can be outputed as well :D</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, 
                    <span class="dt">dimnames =</span> <span class="kw">list</span>(letters[<span class="dv">11</span><span class="op">:</span><span class="dv">15</span>], letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))
tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(my_matrix, <span class="dt">con =</span> tmp.file)
<span class="co">#&gt; NULL</span>

<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; a    b   Names</span>
<span class="co">#&gt; #!{Type}E    E   C</span>
<span class="co">#&gt; 1    6   k</span>
<span class="co">#&gt; 2    7   l</span>
<span class="co">#&gt; 3    8   m</span>
<span class="co">#&gt; 4    9   n</span>
<span class="co">#&gt; 5    10  o</span></code></pre></div>
</div>
<div id="list" class="section level2">
<h2>list</h2>
<p>Lists are a little trickier, currently it looks for named elements that match the arguments, so it would use the elements named: <code>main</code> <code>annotCols</code> <code>annotRows</code> and <code>descr</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
my_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">main =</span> <span class="kw">data.frame</span>(<span class="dt">A =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">B =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>),
                <span class="dt">annotRows =</span> <span class="kw">data.frame</span>(<span class="dt">is_control =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)),
                <span class="dt">annotCols =</span> <span class="kw">data.frame</span>(<span class="dt">Names =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]),
                <span class="dt">descr =</span> <span class="kw">c</span>(<span class="st">'something'</span>,
                          <span class="st">'something else'</span>,
                          <span class="st">'yet another thing'</span>))
tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(my_list, <span class="dt">con =</span> tmp.file)
<span class="co">#&gt; NULL</span>
<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; A    B   Names</span>
<span class="co">#&gt; #!{Description}something something else  yet another thing</span>
<span class="co">#&gt; #!{Type}E    E   C</span>
<span class="co">#&gt; #!{C:is_control}TRUE FALSE   </span>
<span class="co">#&gt; 1    6   a</span>
<span class="co">#&gt; 2    7   b</span>
<span class="co">#&gt; 3    8   c</span>
<span class="co">#&gt; 4    9   d</span>
<span class="co">#&gt; 5    10  e</span></code></pre></div>
</div>
<div id="expressionset-objects-1" class="section level2">
<h2>expressionSet objects</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eSet &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw">ExpressionSet</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">2</span>))
tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(eSet, <span class="dt">con =</span> tmp.file)
<span class="co">#&gt; NULL</span>
<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; X1   X2</span>
<span class="co">#&gt; #!{Type}E    E</span>
<span class="co">#&gt; 1    6</span>
<span class="co">#&gt; 2    7</span>
<span class="co">#&gt; 3    8</span>
<span class="co">#&gt; 4    9</span>
<span class="co">#&gt; 5    10</span></code></pre></div>
</div>
<div id="adding-elements-to-the-output" class="section level2">
<h2>Adding elements to the output</h2>
<p>Since not all data typer support allthe elements, one can specify them to the function and they will be passed over to the output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, 
                    <span class="dt">dimnames =</span> <span class="kw">list</span>(letters[<span class="dv">11</span><span class="op">:</span><span class="dv">15</span>], letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))
my_annotations_rows &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">My_Names =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])
my_annotations_cols &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">My_Genes =</span> letters[<span class="dv">11</span><span class="op">:</span><span class="dv">15</span>])
tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(my_matrix, <span class="dt">con =</span> tmp.file, 
              <span class="dt">annotCols =</span> my_annotations_cols,
              <span class="dt">annotRows =</span> my_annotations_rows)
<span class="co">#&gt; NULL</span>

<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; a    b   My_Genes</span>
<span class="co">#&gt; #!{Type}E    E   C</span>
<span class="co">#&gt; #!{C:My_Names}a  b   </span>
<span class="co">#&gt; 1    6   k</span>
<span class="co">#&gt; 2    7   l</span>
<span class="co">#&gt; 3    8   m</span>
<span class="co">#&gt; 4    9   n</span>
<span class="co">#&gt; 5    10  o</span></code></pre></div>
</div>
<div id="removing-elements-form-the-output" class="section level2">
<h2>Removing elements form the output</h2>
<p>Elements can be set to <code>NULL</code> to remove that section from the output</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, 
                    <span class="dt">dimnames =</span> <span class="kw">list</span>(letters[<span class="dv">11</span><span class="op">:</span><span class="dv">15</span>], letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))
tmp.file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext=</span><span class="st">&quot;txt&quot;</span>)
<span class="kw">write.perseus</span>(my_matrix, <span class="dt">con =</span> tmp.file, 
              <span class="dt">annotCols =</span> <span class="ot">NULL</span>)
<span class="co">#&gt; NULL</span>

<span class="kw">cat</span>(<span class="kw">readLines</span>(tmp.file), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
<span class="co">#&gt; a    b   Names</span>
<span class="co">#&gt; #!{Type}E    E   C</span>
<span class="co">#&gt; 1    6   k</span>
<span class="co">#&gt; 2    7   l</span>
<span class="co">#&gt; 3    8   m</span>
<span class="co">#&gt; 4    9   n</span>
<span class="co">#&gt; 5    10  o</span></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
